<%- include('partials/head', { title: 'ç®¡ç†åå°' }) %>

  <!-- å¯¼èˆª -->
  <nav class="glass-solid sticky top-0 z-40 px-6 py-3">
    <div class="max-w-6xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-rose-500 to-orange-500 flex items-center justify-center text-sm">ğŸ‘</div>
        <span class="text-white font-semibold hidden sm:block">å°å§¨å­ã®åå°</span>
      </div>
      <div class="flex items-center gap-3">
        <a href="/" class="text-xs px-3 py-1.5 rounded-full glass text-gray-300 hover:text-white transition">è¿”å›é¢æ¿</a>
        <a href="/auth/logout" class="text-xs px-3 py-1.5 rounded-full glass text-gray-300 hover:text-red-400 transition">é€€å‡º</a>
      </div>
    </div>
  </nav>


  <!-- Tab å¯¼èˆª -->
  <div class="max-w-6xl mx-auto px-4 sm:px-6 pt-4">
    <div class="sm:hidden mb-2">
      <label class="text-[11px] text-gray-500 block mb-1">å¿«é€Ÿåˆ‡æ¢åŠŸèƒ½</label>
      <select id="tab-select" onchange="switchTab(this.value)" class="w-full bg-black/30 text-white px-3 py-2 rounded-xl border border-white/10 text-sm">
        <optgroup label="æ ¸å¿ƒ">
          <option value="nodes">ğŸŒ èŠ‚ç‚¹</option>
          <option value="users">ğŸ‘¥ ç”¨æˆ·</option>
          <option value="traffic">ğŸ“Š æµé‡</option>
          <option value="whitelist">ğŸ”’ ç™½åå•</option>
        </optgroup>
        <optgroup label="ç›‘æ§">
          <option value="logs">ğŸ“‹ æ—¥å¿—</option>
          <option value="abuse">ğŸ“ˆ è®¢é˜…ç»Ÿè®¡</option>
          <option value="ops">ğŸ§  è¿ç»´</option>
          <option value="diary">ğŸ“” è¿è¥æ—¥è®°</option>
        </optgroup>
        <optgroup label="é…ç½®">
          <option value="notify">ğŸ”” é€šçŸ¥</option>
          <option value="aws">â˜ï¸ AWS</option>
          <option value="settings">âš™ï¸ è®¾ç½®</option>
          <option value="backup">ğŸ’¾ å¤‡ä»½</option>
          <!-- è¯´æ˜å·²ç§»è‡³é¡¹ç›®æ–‡æ¡£ -->
        </optgroup>
      </select>
    </div>
    <div class="relative">
      <div class="flex gap-1 glass-solid rounded-2xl p-1.5 overflow-x-auto scrollbar-hide tab-bar" style="-webkit-overflow-scrolling:touch">
        <!-- æ ¸å¿ƒ -->
        <button onclick="switchTab('nodes')" class="tab-btn active text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="nodes">ğŸŒ èŠ‚ç‚¹</button>
        <button onclick="switchTab('users')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="users">ğŸ‘¥ ç”¨æˆ·</button>
        <button onclick="switchTab('traffic')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="traffic">ğŸ“Š æµé‡</button>
        <button onclick="switchTab('whitelist')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="whitelist">ğŸ”’ ç™½åå•</button>
        <span class="hidden sm:block w-px bg-white/10 my-1.5 mx-1 flex-shrink-0"></span>
        <!-- ç›‘æ§ -->
        <button onclick="switchTab('logs')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="logs">ğŸ“‹ æ—¥å¿—</button>
        <button onclick="switchTab('abuse')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="abuse">ğŸ“ˆ è®¢é˜…</button>
        <button onclick="switchTab('ops')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="ops">ğŸ§  è¿ç»´</button>
        <button onclick="switchTab('diary')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="diary">ğŸ“” æ—¥è®°</button>
        <span class="hidden sm:block w-px bg-white/10 my-1.5 mx-1 flex-shrink-0"></span>
        <!-- é…ç½® -->
        <button onclick="switchTab('notify')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="notify">ğŸ”” é€šçŸ¥</button>
        <button onclick="switchTab('aws')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="aws">â˜ï¸ AWS</button>
        <button onclick="switchTab('settings')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="settings">âš™ï¸ è®¾ç½®</button>
        <button onclick="switchTab('backup')" class="tab-btn text-sm px-3 sm:px-4 py-2 rounded-xl transition whitespace-nowrap" data-tab="backup">ğŸ’¾ å¤‡ä»½</button>
        <!-- æèµ ç®¡ç†å·²ç”±èœœæ¡ƒé…±è‡ªåŠ¨å¤„ç†ï¼Œé€šè¿‡èŠ‚ç‚¹åˆ—è¡¨ç®¡ç† -->
        <!-- è¯´æ˜ tab å·²ç§»é™¤ -->
      </div>
      <div class="tab-fade-right pointer-events-none absolute right-0 top-0 bottom-0 w-12 rounded-r-2xl" style="background:linear-gradient(to right, transparent, rgba(15,11,30,0.95))"></div>
      <div class="sm:hidden text-[10px] text-gray-600 mt-1 text-right">å¯å·¦å³æ»‘åŠ¨æŸ¥çœ‹æ›´å¤šåŠŸèƒ½</div>
    </div>
  </div>

  <main class="max-w-6xl mx-auto px-4 sm:px-6 py-6">
    <%- include('partials/admin-nodes') %>
    <%- include('partials/admin-sections') %>
    <%- include('partials/admin-traffic') %>
    <%- include('partials/admin-ops') %>
    <%- include('partials/admin-diary') %>
    <!-- è¯´æ˜ tab å·²ç§»è‡³é¡¹ç›®æ–‡æ¡£ -->
    <%- include('partials/admin-backup') %>
    <!-- æèµ ç®¡ç†å·²ç§»é™¤ï¼Œç”±èœœæ¡ƒé…±è‡ªåŠ¨å®¡æ ¸ + èŠ‚ç‚¹åˆ—è¡¨ç®¡ç† -->
  </main>

  <style nonce="<%= nonce %>">
    .tab-btn{color:#9ca3af}.tab-btn:hover{color:#fff;background:rgba(255,255,255,0.05)}
    .tab-btn.active{color:#fff;background:rgba(244,63,94,0.2);font-weight:500}
    .tab-panel{display:none}.tab-panel.active{display:block}
  </style>
  <script src="/js/chart.umd.min.js"></script>
  <script src="/js/admin/utils.js"></script>
  <script src="/js/admin/core.js"></script>
  <script src="/js/admin/aws.js"></script>
  <script src="/js/admin/traffic.js"></script>
  <script src="/js/admin/users.js"></script>
  <script src="/js/admin/logs.js"></script>
  <script src="/js/admin/substats.js"></script>
  <script src="/js/admin/notify.js"></script>
  <script nonce="<%= nonce %>">
    // åˆå§‹åŒ–éœ€è¦ hash çš„æ¨¡å—
    if (location.hash === '#aws') setTimeout(() => loadAwsConfig(), 100);
    if (location.hash === '#logs') setTimeout(() => loadLogs(1), 100);
  </script>
<%- include('partials/foot') %>
